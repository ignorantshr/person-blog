
[TOC]
# 磁盘调度算法

## 机械磁盘的结构

![](https://camo.githubusercontent.com/c2266a3544d673bf0b8189d48e051a8c44f061460cf757daa88b2dd3c91f3256/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7869616f6c696e636f6465722f496d616765486f7374322f2545362539332538442545342542442539432545372542332542422545372542422539462f2545382542302538332545352542412541362545372541452539372545362542332539352f2545372541332538312545372539422539382545372542422539332545362539452538342e6a7067)

每个盘面都有自己的磁头。盘片中的每一层分为多个磁道，每个磁道分多个扇区，每个扇区是 `512` 字节。多个具有相同编号的磁道形成一个圆柱，称之为磁盘的柱面。

假设有下面一个请求序列，每个数字代表磁道的位置：
98，183，37，122，14，124，65，67
初始磁头当前的位置是在第 53 磁道。

接下来，分别对以上的序列，作为每个调度算法的例子。

## 先来先服务（First-Come，First-Served，FCFS）

先到来的请求，先被服务。

![](https://camo.githubusercontent.com/b76e57d100fed1fd1f063aaf798fcbcbed31cf4a792c2fece1f1b4bf4f515d7d/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7869616f6c696e636f6465722f496d616765486f7374322f2545362539332538442545342542442539432545372542332542422545372542422539462f2545382542302538332545352542412541362545372541452539372545362542332539352f2545372541332538312545372539422539382545382542302538332545352542412541362d2545352538352538382545362539442541352545352538352538382545362539432538442545352538412541312e706e67)

总共移动了 640 个磁道的距离。

如果大量进程竞争使用磁盘，请求访问的磁道可能会很分散，那先来先服务算法在性能上就会显得很差，因为**寻道时间过长**。

## 最短寻道时间优先（Shortest Seek First，SSF）

优先选择从当前磁头位置所需寻道时间最短的请求。

根据距离磁头（53 位置）最近的请求的算法，具体的请求则会是下列从左到右的顺序：
65，67，37，14，98，122，124，183。

![](https://camo.githubusercontent.com/cd62ebec9228fd6db1b8a62173bba6ade284c1d388b36bfbeb1b42d167512e35/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7869616f6c696e636f6465722f496d616765486f7374322f2545362539332538442545342542442539432545372542332542422545372542422539462f2545382542302538332545352542412541362545372541452539372545362542332539352f2545372541332538312545372539422539382545382542302538332545352542412541362d2545362539432538302545372539462541442545352541462542422545392538312539332545362539372542362545392539372542342545342542432539382545352538352538382e706e67)

磁头移动的总距离是 236 磁道，相比先来先服务性能提高了不少。

假设是一个动态的请求，如果后续来的请求都是小于 183 磁道的，那么 183 磁道可能永远不会被响应，于是就产生了**饥饿现象，这里产生饥饿的原因是磁头在一小块区域来回移动**。

## 扫描（Scan）

磁头在一个方向上移动，访问所有未完成的请求，**直到磁头到达该方向上的最后的磁道，才调换方向**，这种算法也叫做电梯算法。

假设扫描调度算先朝磁道号减少的方向移动，具体请求则会是下列从左到右的顺序：
37，14，0，65，67，98，122，124，183。

![](https://camo.githubusercontent.com/d6a62d0bbc0b2aa4572eaf17ce09b234366114c9e9e962efa82f55ed7e993cd2/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7869616f6c696e636f6465722f496d616765486f7374322f2545362539332538442545342542442539432545372542332542422545372542422539462f2545382542302538332545352542412541362545372541452539372545362542332539352f2545372541332538312545372539422539382545382542302538332545352542412541362d2545362538392541422545362538462538462545372541452539372545362542332539352e706e67)

扫描调度算法性能较好，不会产生饥饿现象，但是存在这样的问题，中间部分的磁道会比较占便宜，中间部分相比其他部分响应的频率会比较多，也就是说每个磁道的响应频率存在差异。

## 循环扫描（Circular Scan, CSCAN ）

只有磁头朝某个特定方向移动时，才处理磁道访问请求，而返回时直接快速移动至最靠边缘的磁道，也就是**复位磁头**，这个过程是很快的，并且**返回中途不处理任何请求**，该算法的特点，就是**磁道只响应一个方向上的请求**。

假设循环扫描调度算先朝磁道增加的方向移动，具体请求会是下列从左到右的顺序：
65，67，98，122，124，183，199，0，14，37。

![](https://camo.githubusercontent.com/48077853addb3da385889745c77d7f9877f5bbc0052a7d721a611b37b50aa367/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7869616f6c696e636f6465722f496d616765486f7374322f2545362539332538442545342542442539432545372542332542422545372542422539462f2545382542302538332545352542412541362545372541452539372545362542332539352f2545372541332538312545372539422539382545382542302538332545352542412541362d432d5343414e2545372541452539372545362542332539352e706e67)

循环扫描算法相比于扫描算法，对于各个位置磁道响应频率相对比较平均。

## LOOK 与 C-LOOK 算法

扫描算法和循环扫描算法，都是磁头移动到磁盘「最始端或最末端」才开始调换方向。

那这其实是可以优化的，优化的思路就是**磁头在移动到「最远的请求」位置，然后立即反向移动**。

针对 SCAN 算法的优化则叫 `LOOK 算法`，它的工作方式，磁头在每个方向上仅仅移动到最远的请求位置，然后立即反向移动，而不需要移动到磁盘的最始端或最末端才反向移动，**反向移动的途中会响应请求**。

![](https://camo.githubusercontent.com/2a7cbf2a682687c7ed78ec08c928bc315e3c828ab2990adaacacf00afd5290be/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7869616f6c696e636f6465722f496d616765486f7374322f2545362539332538442545342542442539432545372542332542422545372542422539462f2545382542302538332545352542412541362545372541452539372545362542332539352f2545372541332538312545372539422539382545382542302538332545352542412541362d4c4f4f4b2545372541452539372545362542332539352e706e67)

针对 C-SCAN 算法的优化则叫 `C-LOOK`，它的工作方式，磁头在每个方向上仅仅移动到最远的请求位置，然后立即反向移动，而不需要移动到磁盘的最始端或最末端才反向移动，**反向移动的途中不会响应请求**。

![](https://camo.githubusercontent.com/4aef7bde5892618701a795a0a12be4650c6c549d21fc35fd7b4b76ba82e27341/68747470733a2f2f63646e2e6a7364656c6976722e6e65742f67682f7869616f6c696e636f6465722f496d616765486f7374322f2545362539332538442545342542442539432545372542332542422545372542422539462f2545382542302538332545352542412541362545372541452539372545362542332539352f2545372541332538312545372539422539382545382542302538332545352542412541362d432d4c4f4f4b2545372541452539372545362542332539352e706e67)
